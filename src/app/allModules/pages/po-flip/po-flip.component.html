<div id="poflip" class="page-layout carded" fusePerfectScrollbar>
  <div class="center">
    <div fxLayout class="main-content">
      <div fxLayout id="main-content-header-card">
        <div fxLayout fxFlex class="my-8 px-24" fxLayoutAlign="end">
          <button (click)="ResetControl()" *ngIf="!SelectedBPCFLIPHeader?.FLIPID" class="mr-8" mat-stroked-button>
            Cancel</button>
          <button (click)="DeleteClicked()" *ngIf="SelectedBPCFLIPHeader?.FLIPID" class="DeleteBtn mr-8"
            mat-stroked-button>
            Delete</button>
          <button (click)="SaveClicked()" *ngIf="!SelectedBPCFLIPHeader?.FLIPID" class="SaveBtn mr-40" mat-raised-button>
            Save</button>
          <button (click)="SaveClicked()" *ngIf="SelectedBPCFLIPHeader?.FLIPID" class="SaveBtn mr-40" mat-raised-button>
            Update</button>
        </div>
      </div>
      <div fxFlex class="main-content-content-card" style="margin-top: 50px !important;">
        <div fxLayout="column">
          <div fxLayout="row">
            <div class="mx-8 mb-8 mt-0 p-8 leftCard">
              <div fxLayout fxLayoutAlign="space-between center">
                <div fxFlex><strong>PO No : {{BPCOFHeader?.DocNumber}}</strong></div>
                <div *ngIf="!SelectedBPCFLIPHeader?.FLIPID" fxFlex fxLayoutAlign="end" class="mr-8">
                  <img class="m-8" style="height: 20px !important;" src="assets/images/alert.png">
                  <span style="margin-top: 10px;">No Flip Created for this PO</span>
                </div>
                <div *ngIf="SelectedBPCFLIPHeader?.FLIPID" fxFlex fxLayoutAlign="end" class="mr-8">
                  <span style="margin-top: 10px;"><strong>FLIP : {{SelectedBPCFLIPHeader?.FLIPID}}</strong></span>
                </div>
              </div>
              <div style="font-size: 11px">
                <div style="margin-top: 10px;color: #2e2e2e">
                  <span style="margin-right: 10px;font-size: 13px;">InvoiceDate :
                    {{ BPCOFHeader?.DocDate| date : 'dd/MM/yyyy'}}</span>
                </div>
              </div>
            </div>
          </div>
          <form autocomplete="off" fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto" name="form" novalidate
            [formGroup]="poFlipDetailsFormGroup">
            <div fxLayout="row" fxLayoutAlign="start">
              <div fxFlex="100">
                <div fxFlex="50">
                  <mat-form-field class="pl-8 pr-24" style="width: 100%;">
                    <input matInput placeholder="Invoice No" formControlName="InvoiceNumber">
                    <mat-error
                      *ngIf="poFlipDetailsFormGroup.get('InvoiceNumber').touched && poFlipDetailsFormGroup.get('InvoiceNumber').hasError('required')">
                      Invoice Number is required
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="50" style="margin-left: 10px;">
                  <mat-form-field class="pl-8 pr-24" style="width: 100%;">
                    <input matInput placeholder="Date" [matDatepicker]="picker1" formControlName="InvoiceDate">
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                    <mat-error
                      *ngIf="poFlipDetailsFormGroup.get('InvoiceDate').touched && poFlipDetailsFormGroup.get('InvoiceDate').hasError('required')">
                      Date is required
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div fxFlex="100">
                <div fxFlex="50" style="margin-left: 16%;">
                  <mat-form-field class="pl-8 pr-24" style="width: 100%;">
                    <input matInput placeholder="Invoice Amount" formControlName="InvoiceAmount"
                      (keydown)="numberOnly($event)">
                    <mat-error
                      *ngIf="poFlipDetailsFormGroup.get('InvoiceAmount').touched && poFlipDetailsFormGroup.get('InvoiceAmount').hasError('required')">
                      Invoice Amount is required
                    </mat-error>
                    <mat-error *ngIf="poFlipDetailsFormGroup.get('InvoiceAmount').touched && !poFlipDetailsFormGroup.get('InvoiceAmount').hasError('required')
                  &&poFlipDetailsFormGroup.get('InvoiceAmount').hasError('pattern')">
                      Enter a valid number
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex=35>
                  <mat-form-field class="pl-8 pr-24" style="width: 100%;">
                    <mat-select (selectionChange)="invoiceCurrencySelected($event)" placeholder="Currency"
                      formControlName="InvoiceCurrency">
                      <mat-option value="USD">USD</mat-option>
                      <mat-option value="INR">INR</mat-option>
                    </mat-select>
                    <mat-error
                      *ngIf="poFlipDetailsFormGroup.get('InvoiceCurrency').touched && poFlipDetailsFormGroup.get('InvoiceCurrency').hasError('required')">
                      Currency is required
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
            <div fxLayout="row" fxLayoutAlign="start">
              <div fxFlex="100">
                <div fxFlex=50 style="margin-top: 18px;">
                  <mat-form-field class="pl-8 pr-24" style="width: 100%;">
                    <mat-select placeholder="Invoice Type" (selectionChange)="invoiceTypeSelected($event)"
                      formControlName="InvoiceType">
                      <mat-option value="Registered">Registered</mat-option>
                      <mat-option value="Service">Service</mat-option>
                    </mat-select>
                    <mat-error
                      *ngIf="poFlipDetailsFormGroup.get('InvoiceType').touched && poFlipDetailsFormGroup.get('InvoiceType').hasError('required')">
                      Invoice Type is required
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="50" style="margin-left: 20px;">
                  <div>
                    <span>Invoice Attachment</span>
                  </div>
                  <div fxLayout>
                    <div fxFlex="60" fxLayout class="Rectangle">
                      <div class="Rectangle-106 m-8">
                        <img class="m-8" style="height: 10px;" src="assets/images/imageIcon.png">
                      </div>
                      <div fxFlex class="m-8" fxLayout="column">
                        <div fxFlex style="font-size: 10px;">{{fileToUpload?.name}}</div>
                        <div fxFlex style="font-size: 10px;">{{fileToUpload?.size}}</div>
                      </div>
                    </div>
                    <div fxLayout="column" style="margin-left: 10px;width: 40% !important;">
                      <div fxFlex fxLayout="column">
                        <div fxFlex style="font-size: 10px;margin-top: -16px;color: #3380d7;font-weight: 600;
                        cursor: pointer !important;">
                          <span class="addAttachmentClass" (click)="fileInput1.click()"> + add Attachment </span>
                          <input hidden type="file" accept="image/x-png,image/gif,image/jpeg,image/jpg" #fileInput1
                            id="file" (change)="handleFileInput($event)" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div fxFlex="100" style="margin-top: 25px">
                <mat-radio-group formControlName="IsInvoiceOrCertified" style="margin-left: 15%;">
                  <mat-radio-button value="1" style="margin-left: 10px;">Invoice</mat-radio-button>
                  <mat-radio-button value="2" style="margin-left: 10%;">Certified</mat-radio-button>
                  <mat-error
                    *ngIf="poFlipDetailsFormGroup.get('IsInvoiceOrCertified').touched && poFlipDetailsFormGroup.get('IsInvoiceOrCertified').hasError('required')">
                    Invoice/Certified is required
                  </mat-error>
                </mat-radio-group>
              </div>
            </div>
          </form>
          <div fxFlex fxLayout="column" class="mt-24">
            <div fxLayout="row" fxLayoutAlign="space-between center">
              <div fxFlex fxLayout="row" fxLayoutAlign="start center" style="margin-left: 7px">
                <div>
                  <span class="title"><strong>Other Cost</strong></span>
                </div>
              </div>
              <div fxFlex style="margin-right: 5% !important;" align="end">
                <!-- <img class="addIcon" src="assets/images/logos/add-button.png"> -->
              </div>
            </div>
            <div>
              <form autocomplete="off" fxLayout="row" fxLayoutAlign="start" fxFlex="1 0 auto" name="form" novalidate
                [formGroup]="poFlipCostDetailsFormGroup">
                <div fxFlex="25">
                  <mat-form-field class="pl-8 pr-12 mat-formClass" style="width: 100%;">
                    <input matInput placeholder="Invoice Type" formControlName="ExpenceType">
                    <mat-error
                      *ngIf="poFlipCostDetailsFormGroup.get('ExpenceType').touched && poFlipCostDetailsFormGroup.get('ExpenceType').hasError('required')">
                      Invoice Type is required
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="25">
                  <mat-form-field class="pl-8 pr-24 mat-formClass" style="width: 100%;">
                    <input matInput placeholder="Amount" formControlName="Amount">
                    <mat-error
                      *ngIf="poFlipCostDetailsFormGroup.get('Amount').touched && poFlipCostDetailsFormGroup.get('Amount').hasError('required')">
                      Amount is required
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="25">
                  <mat-form-field class="pl-8 pr-12 mat-formClass" style="width: 100%;">
                    <input matInput placeholder="Remarks" formControlName="Remarks">
                    <mat-error
                      *ngIf="poFlipCostDetailsFormGroup.get('Remarks').touched && poFlipCostDetailsFormGroup.get('Remarks').hasError('required')">
                      Remarks is required
                    </mat-error>
                  </mat-form-field>
                </div>
                <div fxFlex="20" fxLayoutAlign="end">
                  <img class="addIcon" src="assets/images/logos/add-button.png" (click)="AddPOFlipCostToTable()">
                </div>
              </form>
            </div>
            <div style="margin-left: 8px;">
              <div fxLayout>
                <table *ngIf="POFLIPCostByVOB?.length" class="table" mat-table
                  [dataSource]="poFlipCostDetailsDataSource" matSort>

                  <ng-container matColumnDef="ExpenceType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 25%;"> Type </th>
                    <td mat-cell *matCellDef="let element;let odd=odd" class="tableLeftBorder pl-0">
                      <div fxLayout>
                        <div class="tableCellBorder" [style.background-color]="odd?'#6f52ed':'#d87e39'"></div>
                        <div fxFlex class="pl-4">{{element.ExpenceType}} </div>
                      </div>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="Amount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 25%;"> Amount </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.Amount}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Remark">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 39%;"> Remark </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.Remarks}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Action">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ... </th>
                    <td mat-cell *matCellDef="let element">
                      <img class="m-8" style="height: 20px;" src="assets/images/line.png"
                        (click)="RemovePOFlipCostFromTable(element)"> </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="poFlipCostDetailsDisplayedColumns;sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: poFlipCostDetailsDisplayedColumns;let even=even" matRipple
                    style=" cursor: pointer;">
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div fxFlex fxLayout="column" class="mt-24">
            <div fxLayout="row" fxLayoutAlign="space-between center">
              <div fxFlex fxLayout="row" fxLayoutAlign="start center">

              </div>
              <div fxFlex align="end">
                <button class="Btn" mat-stroked-button>Full Filp</button>
              </div>
            </div>
            <div style="margin-left: 8px;margin-top: 10px;">
              <div fxLayout>
                <table *ngIf="PODetails?.length" class="table" mat-table [dataSource]="poDetailsDataSource" matSort>

                  <ng-container matColumnDef="PO">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> PO </th>
                    <td mat-cell *matCellDef="let element;let odd=odd" class="tableLeftBorder pl-0">
                      <div fxLayout>
                        <div class="tableCellBorder" [style.background-color]="odd?'#6f52ed':'#d87e39'"></div>
                        <div fxFlex class="pl-4">{{element.PO}} </div>
                      </div>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="MaterialTxt">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> MaterialTxt </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.MaterialTxt}} </td>
                  </ng-container>

                  <ng-container matColumnDef="HSN">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> HSN </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.HSN}} </td>
                  </ng-container>


                  <ng-container matColumnDef="OpenQty">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> OpenQty </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.OpenQty}} </td>
                  </ng-container>

                  <ng-container matColumnDef="InvoiceQty">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> InvoiceQty </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.InvoiceQty}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Price">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Price </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.Price}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Tax">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Tax </th>
                    <td mat-cell *matCellDef="let element">
                      <span style="color:#ef8377">{{element.Tax}}</span> <img class="mt-4 ml-4" style="height: 7px;"
                        src="assets/images/play-button-arrowhead.png"> </td>
                  </ng-container>

                  <ng-container matColumnDef="Amount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Amount </th>
                    <td mat-cell *matCellDef="let element">
                      {{element.Amount}} </td>
                  </ng-container>

                  <ng-container matColumnDef="Action">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ... </th>
                    <td mat-cell *matCellDef="let element">
                      <img class="m-8" style="height: 20px;" src="assets/images/line.png"> </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="poDetailsDisplayedColumns;sticky: true"></tr>
                  <tr mat-row *matRowDef="let row; columns: poDetailsDisplayedColumns;let even=even" matRipple
                    style=" cursor: pointer;">
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div fxFlex fxLayout="column" class="mt-24">
            <div fxLayoutAlign="center">
              <button class="Btn1" mat-button>Preview and Download</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <mat-progress-spinner *ngIf="IsProgressBarVisibile" class="progressBarPostion" color="accent" mode="indeterminate">
    </mat-progress-spinner>
    <div id="overlay" *ngIf="IsProgressBarVisibile"></div>
  </div>
</div>